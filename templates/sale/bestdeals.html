{% extends "base.html" %}
{% load static %}
{% block title %}Best Deals | Kinbo Shop{% endblock %}
{% block footer %}{% endblock %}
{% block content %}
  <div class="w-full bg-orange-50 py-6">
    <div class="max-w-[1320px] mx-auto px-4"> 
      <!-- Responsive Banner Image -->
      <img src="{% static 'images/bestdeals.jpg' %}" alt="Best Deals Banner" class="w-full h-40 sm:h-52 md:h-60 lg:h-80 object-cover rounded-lg" />
    </div>
  </div>
  <!-- ===========================
     PAGE TITLE
=========================== -->
  <div class="max-w-[1320px] mx-auto mt-8 px-4">
    <h1 class="text-2xl font-bold text-orange-600">
      Best Deals
    </h1>
    <p class="text-gray-600 mt-2">Exclusive offers and limited time discounts</p>
  </div>
  <section class="max-w-[1320px] mx-auto px-4 mt-8">
    {% if best_deal_products %}
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
        {% for product in best_deal_products %}
          <div class="bg-white shadow-lg rounded-xl overflow-hidden hover:shadow-xl transition-all duration-300 border border-orange-100">
            <!-- Product Image -->
            <div class="relative">
              <a href="{{ product.get_url }}">
                <img src="{{ product.image.url }}" class="w-full h-48 object-cover" alt="{{ product.product_name }}">
              </a>
                  
              <!-- Discount Badge -->
              {% for deal in best_deals %}
                {% if deal.product.id == product.id and deal.discount_percentage > 0 %}
                  <div class="absolute top-3 left-3 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold">
                    {{ deal.discount_percentage }}% OFF
                  </div>
                {% endif %}
              {% endfor %}
              </div>
              
              <!-- Product Info -->
              <div class="p-4">
                  <!-- Deal Title -->
                {% for deal in best_deals %}
                  {% if deal.product.id == product.id %}
                    <h3 class="text-lg font-bold text-orange-700 mb-1">{{ deal.title }}</h3>
                    {% if deal.subtitle %}
                      <p class="text-gray-600 text-sm mb-2">{{ deal.subtitle }}</p>
                    {% endif %}
                  {% endif %}
                {% endfor %}
                  
                  <!-- Product Name -->
                <a href="{{ product.get_url }}" class="font-semibold text-gray-800 hover:text-orange-600 block mb-2">
                  {{ product.product_name }}
                </a>
                  
                  <!-- Price Section -->
                <div class="flex items-center justify-between mt-3">
                  <div class="flex items-center space-x-2">
                    {% if product.discount_price %}
                      <p class="text-red-600 font-bold text-lg">{{ product.discount_price }} TK</p>
                      <del class="text-gray-500 text-sm">{{ product.price }} TK</del>
                    {% else %}
                      <p class="text-orange-600 font-bold text-lg">{{ product.price }} TK</p>
                    {% endif %}
                  </div>
                  <!-- Add to Cart Button -->
                  <a href="{% url 'add_cart' product.id %}" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors">
                    Add to Cart
                  </a>
                </div>
            </div>
          </div>
        {% endfor %}
      </div>
    
    {% else %}
    <!-- No Products Message -->
      <div class="text-center py-12">
        <img src="{% static 'images/empty-deals.png' %}" class="h-32 mx-auto mb-4" alt="No deals">
        <h3 class="text-xl font-semibold text-gray-600">No Best Deals Available</h3>
        <p class="text-gray-500 mt-2">Check back later for amazing offers!</p>
        <a href="{% url 'store' %}" class="inline-block mt-4 bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700">
          Continue Shopping
        </a>
      </div>
    {% endif %}
  </section>

<!-- ===========================
     FEATURED CATEGORIES SECTION
=========================== -->
  <section class="max-w-[1320px] mx-auto px-4 mt-16">
    <h2 class="text-2xl font-bold text-orange-600 mb-6 text-center">Shop by Category</h2>
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4">
      {% for cat in popular_categories %}
        <a href="{{ cat.get_url }}" class="block">
          <div class="bg-orange-50 h-24 rounded-lg shadow flex items-center justify-center text-orange-600 font-semibold hover:bg-orange-100 transition-colors">
            {{ cat.category_name }}
          </div>
        </a>
      {% endfor %}
    </div>
  </section>
{% endblock %}
